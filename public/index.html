<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Remind – Delirium Support Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <div class="app-header-main">
      <h1>Remind</h1>
      <p class="subtitle">Memory game performance dashboard for delirium risk support</p>
    </div>
    <div class="app-header-meta">
      <span class="tag">Prototype</span>
      <span class="tag tag-warning">Not a diagnostic tool</span>
    </div>
  </header>

  <main class="layout">
    <!-- LEFT COLUMN: Patient + Input -->
    <section class="panel">
      <h2>Patient session</h2>

      <form id="patient-form" class="form-grid" autocomplete="off">
        <div class="form-group">
          <label for="patientId">Patient ID</label>
          <input id="patientId" name="patientId" type="text" required />
        </div>

        <div class="form-group">
          <label for="patientName">Patient name (optional)</label>
          <input id="patientName" name="patientName" type="text" />
        </div>

        <div class="form-group">
          <label for="patientAge">Age</label>
          <input id="patientAge" name="patientAge" type="number" min="0" max="120" />
        </div>

        <div class="form-group">
          <label for="patientLocation">Unit / Room</label>
          <input id="patientLocation" name="patientLocation" type="text" />
        </div>

        <div class="form-group full-width">
          <label for="notes">Clinical notes (optional)</label>
          <textarea id="notes" name="notes" rows="2" placeholder="e.g., post-op day 2, on opioids, baseline cognitive status..."></textarea>
        </div>
      </form>

      <hr class="divider" />

      <h3>Enter game result (temporary manual input)</h3>
      <p class="small muted">
        For now, results are entered manually. Later, these values will be filled automatically from the ESP32.
      </p>

      <form id="result-form" class="form-grid" autocomplete="off">
        <div class="form-group">
          <label for="sequenceLength">Average sequence length</label>
          <input id="sequenceLength" name="sequenceLength" type="number" min="1" required />
        </div>

        <div class="form-group">
          <label for="roundsPlayed">Rounds played</label>
          <input id="roundsPlayed" name="roundsPlayed" type="number" min="1" required />
        </div>

        <div class="form-group">
          <label for="roundsCorrect">Rounds correct</label>
          <input id="roundsCorrect" name="roundsCorrect" type="number" min="0" required />
        </div>

        <div class="form-group">
          <label for="avgReaction">Avg. reaction time (ms)</label>
          <input id="avgReaction" name="avgReaction" type="number" min="0" required />
        </div>

        <div class="form-group full-width">
          <button type="submit" class="btn btn-primary">Save result</button>
          <button type="button" id="demo-btn" class="btn btn-outline">Add demo result</button>
        </div>
      </form>

      <p class="tiny disclaimer">
        Disclaimer: This prototype is for research and educational purposes only. It is <strong>not</strong> validated
        or approved as a medical device and must not be used as a standalone diagnostic tool.
      </p>
    </section>

    <!-- RIGHT COLUMN: Risk + History -->
    <section class="panel">
      <h2>Risk summary</h2>

      <section id="risk-summary" class="risk-card empty-state">
        <p>No data yet. Enter a result to see the cognitive deviation score.</p>
      </section>

      <section class="panel-sub">
        <h3>Session history</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Patient</th>
                <th>Score</th>
                <th>Deviation score</th>
                <th>Risk</th>
              </tr>
            </thead>
            <tbody id="history-body">
              <!-- Filled by app.js -->
            </tbody>
          </table>
        </div>
      </section>

      <section class="panel-sub">
        <h3>Baseline configuration</h3>
        <p class="small">
          These baselines represent an approximate “expected” performance for the Remind game. In a real deployment,
          these values should be tuned using clinical data and validated with specialists.
        </p>

        <form id="baseline-form" class="baseline-grid">
          <div class="form-group">
            <label for="baselineAccuracy">Baseline accuracy</label>
            <input id="baselineAccuracy" type="number" step="0.01" min="0" max="1" />
          </div>
          <div class="form-group">
            <label for="baselineReaction">Baseline reaction (ms)</label>
            <input id="baselineReaction" type="number" min="0" />
          </div>
          <button type="submit" class="btn btn-small">Update baselines</button>
        </form>
      </section>

      <section class="panel-sub">
        <h3>ESP32 connection (future)</h3>
        <p class="small">
          The website is designed so that ESP32 devices or a backend server can push game results into this dashboard.
          For now, this is simulated in JavaScript. Later, you can:
        </p>
        <ul class="small">
          <li>Expose an HTTP endpoint (e.g. <code>POST /api/results</code>) that the ESP32 calls after each game.</li>
          <li>Or use WebSocket / Server-Sent Events for live streaming of results.</li>
        </ul>
        <p class="tiny muted">
          See <code>connectToEsp32()</code> and <code>ingestResultFromDevice()</code> in <code>app.js</code> for
          integration points.
        </p>
      </section>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
